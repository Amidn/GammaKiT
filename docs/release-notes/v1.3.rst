.. include:: ../references.txt

.. _gammapy_1p3_release:

1.3 (October xx, 2024)
-------------------------

- Released October xx, 2024
- xx contributors
- 160 pull requests since v1.2 (not all listed below)
- 59 closed issues

Summary
~~~~~~~

This release introduces a number of performance improvements, new features and bug fixes.
Improved support is provided for joint analysis with different event types.
There has been significant code cleanup, specially with respect to the documentaion and three new tutorials have been added.

This release is compatible with numpy >=2.0. 
Sherpa dependency has beeen fixed to >4.16


API changes
~~~~~~~~~~~

One deprecated change has been introducted in this version:
- The order of arguments in the `FoVBackgroundModel` has been modified; `daatset_name` is now a complusoryt first positional argument.

Features deprecated since Gammapy v1.2 have been removed. 

Infrastructure
~~~~~~~~~~~~~~

- Matomo is now used for website analytics, replacing Google Analytics.


Documentation improvements
~~~~~~~~~~~~~~~~~~~~~~~~~~

- css with sphinx v15 is now used for the docs build.
- Tutorials are now ordered in a logical workflow.
- Three new tutorials have been added: (1) on modelling the EBL absorption, (2) on exposing the general API of `gammapy.estimators` and `FluxMaps`,  (3) on performing time dependent spectroscopy.
- Code examples have been added in docstrings.


New features
~~~~~~~~~~~~

*gammapy.catalogs*

- Support for the 2PC and 3PC pulsar catalogs from Fermi-LAT is now added.


*gammapy.datasets*

- Performance improvement in Fermi-LAT analysis is implemented with adaption in psf kernel computation.
- Stacking of acceptance maps is improved.


*gammapy.maps*

- Multiple non-spatial axes are now supported in MapDataset creation. Full likelihood computation with additional axes is not yet supported.
- Map axes with periodic boundary conditions are now supported.
- An error is raised for maps with invalid input shapes instead of silently broadcasting.

*gammapy.estimators*

- Binwise likelihood profiles are now stored on FluxMaps. 
- FluxMaps obtained from different datasets (eg: different event types) can be combined.

*gammapy.stats*

- Timmer-Koenig algorithm with leakage protection to simulate a time series from a power spectrum is implemented.
- Discrete structure function for a variable source using Emmanoulopoulos et al. (2010) algorithm is added.
- Discrete cross correlation function computation is added.


*gammapy.modeling*

- The `FitResult` object is exposed as an important API element, combining the results from the optimisation and covariance of the fit.
- Unique naming of model parameters adapted, leading to resolution of issues with computation of the covariance matrix for complex model lists.
- New tutorial added for modeling EBL absorption.
- Time scale issue in simulation energy dependent temporal models resolved.
- Definition of `UniformPrior` fixed to return 0 within min and max values indstead of one.

Bug fixes and improvements
~~~~~~~~~~~~~~~~~~~~~~~~~~

- ON and OFF phase intervals are copied in PhaseBackgroundMaker
- Add min_pix option in `WcsGeom.cutout`
- Add copy method on FluxMaps
- Fix select_nested_models if there is no free parameters for the null hypothesis
- css for sphinx v15
- Allow extrapolation only along spatial dimension in mask_safe_edisp
- Add write function to `FitResult`
- Expose `FitResult` object
- Fix cutout_template_models to work if models is None
- Fix angle wrapping of spatial parameters in `PiecewiseNormSpatialModel`
- Fix map evaluation if no edisp is set
- Add missing parallel processing options
- Add `TimeMapAxis.to_table()` 
- Add a warning in `TemplateSpatialModel` for presence of nan values 
- Fix TSmapEstimator stat_scan with sum_over_energy_group=False
- Fix ignored overwrite in datasets.write
- Improve plotting of spectral residuals by removing the mask in computation but rathere adding a visual mask
- Add strict option to MapAxis.downsample
- Add alpha maps to ExcessMapEstimator

Pull Requests
~~~~~~~~~~~~~

This list is incomplete. Small improvements and bug fixes are not listed here.


